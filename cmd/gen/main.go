package main

import (
	"fmt"
	"os"
	"os/exec"
	"strings"
)

func main() {
	// ""  : no effect
	// "-i": invert
	// "-g": grayscale
	opts := []string{"-i", "-g", ""}

	// xs s m l xl
	sizes := []string{"30", "60", "90", "120", "150"}

	for _, opt := range opts {
		for _, size := range sizes {
			var (
				out []byte
				err error
			)

			// if "" is passed as option, im2a shows error
			if opt == "" {
				out, err = exec.Command("im2a", "-p", "-W", size, "vkgtaro.jpg").Output()
			} else {
				out, err = exec.Command("im2a", "-p", "-W", size, opt, "vkgtaro.jpg").Output()
			}
			if err != nil {
				panic(err)
			}

			filename := fmt.Sprintf("images/vkgtaro_%s%s.go", size, strings.Replace(opt, "-", "_", -1))
			file, err := os.OpenFile(filename, os.O_WRONLY|os.O_CREATE, 0666)
			if err != nil {
				panic(err)
			}
			defer file.Close()

			fmt.Fprintln(file, fmt.Sprintf(format, size, strings.Replace(opt, "-", "_", -1), string(out)))
		}
	}
}

const format = `// Code generated by cmd/gen/main.go. DO NOT EDIT.
package images

const AsciiVkgtaro%s%s = ` + "`" + `
%s
` + "`"
